<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flask Client</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #items { margin-bottom: 20px; }
        #item-list { list-style-type: none; padding: 0; }
    </style>
</head>
<body>
    <h1>Flask Client</h1>

    <!-- Display Items -->
    <div id="items">
        <h2>Category</h2>
        <ul id="cat-list"></ul>
        <input type="button" value="Show Categry" onclick="fetchCate()">
        <h2>Items</h2>
        <ul id="item-list"></ul>
        <input type="button" value="Show items" onclick="fetchItems()">
        <h2>
            SEARCH FOR AN ITEM BY ITS ID:
        </h2>
        <ul id="idItem"></ul>
        <input type="number" id="quantity" name="quantity" min="1" max="10" step="1" value="1">
        <input type="button" value="SEARCH" onclick="search()">
        <h2>
            SEARCH BY NAME:
        </h2>
        <ul id="nameItem"></ul>
        <input type="text" id="name" name="name">
        <input type="button" value="SEARCH" onclick="searchName()">
    </div>

    <script>
        const apiUrl = 'http://127.0.0.1:5000'; //Update with your Flask server URL
//In JavaScript, async and await 
//are used to handle asynchronous operations
//in a more readable and maintainable way compared to traditional methods like callbacks


// Function to search by name
async function searchName() {
    try {
        const nameInput = document.getElementById('name');
        const nameValue = nameInput.value.trim(); // Trim whitespace

        if (!nameValue) {
            // Handle empty search value
            alert('Please enter a name to search.');
            return;
        }

        const response = await fetch(`${apiUrl}/items/search?name=${encodeURIComponent(nameValue)}`);

        if (response.ok) {
            const items = await response.json(); // Expecting an array of items
            const itemList = document.getElementById('nameItem');
            itemList.innerHTML = ''; // Clear previous data

            if (Array.isArray(items) && items.length > 0) { // Check if items is a non-empty array
                items.forEach(item => {
                    const li = document.createElement('li');
                    li.textContent = `ID: ${item.id || 'N/A'}, Name: ${item.name || 'N/A'}, Price: ${item.price || 'N/A'}`;
                    itemList.appendChild(li);
                });
            } else {
                itemList.textContent = 'Item not found.';
            }
        } else {
            console.error('Failed to fetch items');
            itemList.textContent = 'Error fetching items. Please try again.';
        }
    } catch (error) {
        console.error('Error:', error);
        const itemList = document.getElementById('nameItem');
        itemList.textContent = 'Error fetching items. Please try again.';
    }
}


// Function to search by ID
async function search() {
    try {
        const quantityInput = document.getElementById('quantity');
        const quantityValue = quantityInput.value;
        const response = await fetch(`${apiUrl}/items/${quantityValue}`);

        if (response.ok) {
            const item = await response.json(); // Expecting a single item
            const itemList = document.getElementById('idItem');
            itemList.innerHTML = ''; // Clear previous data

            if (item) { // Check if item is found
                const li = document.createElement('li');
                li.textContent = `ID: ${item.id || 'N/A'}, Name: ${item.name || 'N/A'}, Price: ${item.price || 'N/A'}`;
                itemList.appendChild(li);
            } else {
                itemList.textContent = 'Item not found.';
            }
        } else {
            console.error('Failed to fetch item');
        }
    } catch (error) {
        console.error('Error:', error);
    }
}

// Function to fetch and display categories
async function fetchCate() {
    try {
        const response = await fetch(`${apiUrl}/category`);
        if (response.ok) {
            const categories = await response.json();
            const categoryList = document.getElementById('cat-list');
            categoryList.innerHTML = ''; // Clear previous data
            categories.forEach(category => {
                const li = document.createElement('li');
                li.textContent = `Name: ${category.name || 'N/A'}, Id: ${category.id || 'N/A'}`;
                categoryList.appendChild(li);
            });
        } else {
            console.error('Failed to fetch categories');
        }
    } catch (error) {
        console.error('Error:', error);
    }
}

// Function to fetch and display items
async function fetchItems() {
    try {
        const response = await fetch(`${apiUrl}/items`);
        if (response.ok) {
            const items = await response.json();
            const itemList = document.getElementById('item-list');
            itemList.innerHTML = ''; // Clear previous data
            items.forEach(item => {
                const li = document.createElement('li');
                li.textContent = `Name: ${item.name || 'N/A'}, Price: ${item.price || 'N/A'}, Category ID: ${item.category_id || 'N/A'}, Item Id: ${item.id || 'N/A'}`;
                itemList.appendChild(li);
            });
        } else {
            console.error('Failed to fetch items');
        }
    } catch (error) {
        console.error('Error:', error);
    }
}

       
    </script>
</body>
</html>
